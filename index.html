<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Boys Click Too Fast — v1.6 (Sound + Sequential)</title>
  <style>
    :root{--bg:#0f1115;--panel:#171a21;--text:#e7e7ea;--muted:#9599a6;--ring:#2a3147;
      --c-geum:#65D6A6;--c-gang:#FFE77A;--c-bbab:#FF9BC1;--c-hae:#8ECFFF}
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,"Apple SD Gothic Neo","Noto Sans KR",Segoe UI,Roboto,Arial;
      background:linear-gradient(180deg,#0d0f14,#151922 45%,#0f1115);color:var(--text);display:flex;align-items:center;justify-content:center;padding:16px}
    .app{width:min(980px,100%)} .card{background:radial-gradient(120% 120% at 80% 0%,#1e2230 0%,var(--panel) 45%);border:1px solid #232736;border-radius:20px;box-shadow:0 20px 60px rgba(0,0,0,.45),inset 0 1px 0 rgba(255,255,255,.02);overflow:hidden}
    header{display:flex;gap:12px;align-items:center;justify-content:space-between;padding:16px 18px;border-bottom:1px solid #24283a;background:rgba(255,255,255,.02)}
    .brand{display:flex;align-items:center;gap:12px}.logo{width:34px;height:34px;border-radius:10px;background:conic-gradient(from 200deg,var(--c-geum),var(--c-gang),var(--c-bbab),var(--c-hae));filter:saturate(110%)}
    .title{font-weight:800;letter-spacing:.2px}.subtitle{color:var(--muted);font-size:12px}
    .stats{display:flex;gap:16px;align-items:center}.pill{background:#1f2433;border:1px solid #2a3147;padding:8px 12px;border-radius:12px;font-weight:700}.pill b{color:var(--c-bbab)}
    .content{display:grid;grid-template-columns:1.15fr .85fr;gap:18px;padding:18px}@media (max-width:900px){.content{grid-template-columns:1fr}}
    .play{position:relative;background:linear-gradient(180deg,#192030,#131827);border:1px solid #2a3147;border-radius:16px;padding:18px;overflow:hidden}
    .stage{position:relative;width:100%;aspect-ratio:1/1;border-radius:14px;background:radial-gradient(80% 80% at 50% 45%,#20283b 0%,#151a2a 100%);display:grid;place-items:center}
    .char-wrap{position:relative;width:min(82%,440px);aspect-ratio:1/1;border-radius:50%;background:#0f1115;border:8px solid #252b3f;box-shadow:0 12px 40px rgba(0,0,0,.5),inset 0 2px 10px rgba(255,255,255,.05);overflow:hidden;cursor:pointer;transition:transform .06s ease-out}
    .char-wrap:active{transform:scale(.98)} .char{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}.overlay-ring{position:absolute;inset:-6px;border-radius:50%;border:6px solid rgba(255,255,255,.06);pointer-events:none}
    .heart{position:absolute;width:22px;height:22px;background:currentColor;border-radius:6px;transform:translate(-50%,-50%) rotate(45deg) scale(.9);opacity:.96;animation:floatUp 950ms ease-out forwards;filter:drop-shadow(0 4px 10px rgba(0,0,0,.35))}
    .heart:before,.heart:after{content:"";position:absolute;width:22px;height:22px;background:currentColor;border-radius:50%}.heart:before{left:-11px}.heart:after{top:-11px}
    @keyframes floatUp{0%{transform:translate(var(--x,0),var(--y,0)) rotate(45deg) scale(.9);opacity:.98}80%{opacity:.98}100%{transform:translate(calc(var(--x,0) - 0px),calc(var(--y,-130px))) rotate(45deg) scale(.8);opacity:0}}
    .word{position:absolute;transform:translate(-50%,-50%);font-weight:900;font-size:18px;letter-spacing:.2px;text-shadow:0 2px 10px rgba(0,0,0,.35);opacity:0;animation:popWord 1.1s ease-out forwards}
    @keyframes popWord{0%{transform:translate(var(--x,0),var(--y,0)) scale(.8);opacity:0}15%{opacity:1;transform:translate(var(--x,0),var(--y,0)) scale(1)}100%{transform:translate(calc(var(--x,0) - 0px),calc(var(--y,-120px))) scale(1);opacity:0}}
    .panel{background:#141a2a;border:1px solid #2a3147;border-radius:16px;padding:14px;display:flex;flex-direction:column;gap:12px}.panel h3{margin:0 0 6px 0;font-size:14px;color:#cbd3ff;letter-spacing:.3px}
    .row{display:flex;gap:8px;flex-wrap:wrap}button,.file{appearance:none;border:1px solid #2a3147;background:#1b2233;color:#e7e7ea;padding:10px 12px;border-radius:12px;font-weight:700;cursor:pointer;transition:transform .05s ease-out,background .2s}
    button:hover{background:#222a3e}button:active{transform:translateY(1px)}.mini{padding:8px 10px;font-size:12px;border-radius:10px}.primary{background:#252f47;border-color:#334166}
    .footer{padding:10px 16px;border-top:1px solid #24283a;display:flex;gap:10px;justify-content:space-between;align-items:center;font-size:12px;color:#9aa2bf}
    .badge{position:absolute;right:10px;bottom:10px;background:rgba(0,0,0,.45);border:1px solid rgba(255,255,255,.12);padding:6px 10px;border-radius:999px;font-weight:700;font-size:12px}
  </style>
</head>
<body>
  <div class="app card" id="app">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden></div>
        <div>
          <div class="title">Boys Click Too Fast</div>
          <div class="subtitle">Sound on · Heart then Words — 4 Boys Mini Game</div>
        </div>
      </div>
      <div class="stats">
        <div class="pill">Score: <b id="score">0</b></div>
        <div class="pill">Combo: <b id="combo">0</b></div>
        <div class="pill">Best: <b id="best">0</b></div>
      </div>
    </header>

    <div class="content">
      <section class="play">
        <div class="stage" id="stage">
          <div class="char-wrap" id="charWrap" title="클릭!">
            <img id="charImg" class="char" alt="Character">
            <span class="badge" id="who">금량</span>
            <div class="overlay-ring"></div>
          </div>
        </div>
      </section>

      <aside class="panel">
        <div>
          <h3>캐릭터 선택</h3>
          <div class="row">
            <button class="mini" data-char="geum">🐍 금량</button>
            <button class="mini" data-char="gang">🐶 강아지</button>
            <button class="mini" data-char="bbab">👶 빱빱이</button>
            <button class="mini" data-char="hae">🐺 해온이</button>
          </div>
        </div>
        <div>
          <h3>내 이미지로 바꾸기 (PNG 권장)</h3>
          <input class="file" id="file" type="file" accept="image/*" />
          <div class="muted" style="margin-top:6px">정사각형 투명 PNG가 가장 예쁨. 이미지가 동그랗게 마스킹됨.</div>
        </div>
        <div>
          <h3>조작법</h3>
          <div class="muted">마우스 클릭 또는 <span class="kbd">Space</span> / <span class="kbd">Enter</span></div>
        </div>
        <div>
          <h3>게임</h3>
          <div class="row">
            <button id="reset" class="mini">리셋</button>
            <button id="saveImg" class="mini">현재 캐릭터 저장</button>
          </div>
          <div class="muted" style="margin-top:6px">Tip: 10/25/50점 달성 시 축하 문구가 떠요!</div>
        </div>
      </aside>
    </div>

    <div class="footer">
      <div>Made for <b>simple-lab010203</b> · Boys Click Too Fast v1.6</div>
      <div class="muted">순차형(하트→단어) + 기본 효과음</div>
    </div>

    <audio id="sfx" preload="auto" src="sounds/click.wav"></audio>
  </div>

  <script>
    const placeholders = { geum:`data:image/svg+xml;utf8,${encodeURIComponent(`<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 400'><defs><linearGradient id='g' x1='0' y1='0' x2='0' y2='1'><stop offset='0%' stop-color='#1b2130'/><stop offset='100%' stop-color='#121722'/></linearGradient></defs><rect width='400' height='400' rx='200' fill='url(#g)'/><circle cx='200' cy='210' r='135' fill='#0c1513'/><path d='M120 220 q80 -120 160 0' stroke='#65D6A6' stroke-width='20' fill='none' stroke-linecap='round'/><circle cx='160' cy='190' r='10' fill='#65D6A6'/><circle cx='240' cy='190' r='10' fill='#65D6A6'/></svg>`)} ,
      gang:`data:image/svg+xml;utf8,${encodeURIComponent(`<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 400'><rect width='400' height='400' rx='200' fill='#2a3247'/><circle cx='200' cy='210' r='130' fill='#2b2f3f'/><circle cx='160' cy='200' r='16' fill='#FFE77A'/><circle cx='240' cy='200' r='16' fill='#FFE77A'/><path d='M170 250 Q200 270 230 250' stroke='#FFE77A' stroke-width='10' fill='none' stroke-linecap='round'/></svg>`)} ,
      bbab:`data:image/svg+xml;utf8,${encodeURIComponent(`<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 400'><rect width='400' height='400' rx='200' fill='#26314a'/><circle cx='200' cy='210' r='130' fill='#1d2235'/><circle cx='180' cy='200' r='14' fill='#FF9BC1'/><circle cx='220' cy='200' r='14' fill='#FF9BC1'/><circle cx='200' cy='235' r='12' fill='#FF9BC1'/></svg>`)} ,
      hae:`data:image/svg+xml;utf8,${encodeURIComponent(`<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 400'><rect width='400' height='400' rx='200' fill='#223049'/><circle cx='200' cy='215' r='135' fill='#1a2238'/><path d='M150 170 L175 135 L200 170' fill='#8ECFFF'/><path d='M250 170 L275 135 L300 170' fill='#8ECFFF'/></svg>`)} };

    const CHAR = {
      geum: { name:'금량', color:getComputedStyle(document.documentElement).getPropertyValue('--c-geum').trim(), word:'🥟 만두' },
      gang: { name:'강아지', color:getComputedStyle(document.documentElement).getPropertyValue('--c-gang').trim(), word:'🍤 새우' },
      bbab: { name:'빱빱이', color:getComputedStyle(document.documentElement).getPropertyValue('--c-bbab').trim(), word:'압지~👶💞' },
      hae:  { name:'해온이', color:getComputedStyle(document.documentElement).getPropertyValue('--c-hae').trim(), word:'💙 주혁이형' }
    };

    const el = { score:document.getElementById('score'), combo:document.getElementById('combo'), best:document.getElementById('best'), stage:document.getElementById('stage'), charWrap:document.getElementById('charWrap'), charImg:document.getElementById('charImg'), who:document.getElementById('who'), file:document.getElementById('file'), reset:document.getElementById('reset'), saveImg:document.getElementById('saveImg'), sfx:document.getElementById('sfx') };

    const state = { score:0, combo:0, best:Number(localStorage.getItem('bctfHighScore')||0), current:'geum', lastClickAt:0 };

    function setCharacter(key){ state.current = key; document.documentElement.style.setProperty('--active', CHAR[key].color); el.charImg.src = placeholders[key]; el.who.textContent = CHAR[key].name; }
    setCharacter('geum'); el.best.textContent = state.best;

    function rand(min,max){ return Math.random()*(max-min)+min }
    function spawnHeart(x,y,color){ const h=document.createElement('div'); h.className='heart'; h.style.color=color; h.style.setProperty('--x',(x-el.charWrap.getBoundingClientRect().left)+'px'); h.style.setProperty('--y',(y-el.charWrap.getBoundingClientRect().top)+'px'); el.charWrap.appendChild(h); h.addEventListener('animationend',()=>h.remove()); }
    function spawnWord(x,y,color,text){ const w=document.createElement('div'); w.className='word'; w.textContent=text; w.style.color=color; w.style.setProperty('--x',(x-el.charWrap.getBoundingClientRect().left)+'px'); w.style.setProperty('--y',(y-el.charWrap.getBoundingClientRect().top)+'px'); el.charWrap.appendChild(w); w.addEventListener('animationend',()=>w.remove()); }

    function addScore(){ const now=Date.now(); state.combo=(now-state.lastClickAt<=350)?state.combo+1:1; state.lastClickAt=now; const gain=1+Math.floor(state.combo/10); state.score+=gain; el.score.textContent=state.score; el.combo.textContent=state.combo; if(state.score>state.best){ state.best=state.score; el.best.textContent=state.best; localStorage.setItem('bctfHighScore', state.best) } checkMilestones(); }
    function checkMilestones(){ const m=[10,25,50,100,200]; if(m.includes(state.score)){ const {name}=CHAR[state.current]; alert(`Level ${state.score}!  ${name}이(가) 행복해해요 ✨`);} }

    function playClick(){ try{ const a = el.sfx.cloneNode(); a.volume=0.75; a.play().catch(()=>{});}catch(e){} }

    function handleClick(evt){ const rect=el.charWrap.getBoundingClientRect(); const x=evt.clientX ?? (rect.left+rect.width/2); const y=evt.clientY ?? (rect.top+rect.height/2); const {color,word}=CHAR[state.current];
      playClick();
      for(let i=0;i<3;i++){ setTimeout(()=> spawnHeart(x+rand(-24,24), y+rand(-24,24), color), i*45); }
      setTimeout(()=>{ spawnWord(x+rand(-8,8), y+rand(-6,6), color, word); }, 150);
      addScore(); }

    el.charWrap.addEventListener('click', handleClick);
    window.addEventListener('keydown', (e)=>{ if(e.code==='Space' || e.code==='Enter'){ e.preventDefault(); handleClick({}) } });
    document.querySelectorAll('[data-char]').forEach(btn=> btn.addEventListener('click', ()=> setCharacter(btn.dataset.char)));
    el.file.addEventListener('change', (e)=>{ const f=e.target.files?.[0]; if(!f) return; const url=URL.createObjectURL(f); el.charImg.src=url; });
    el.reset.addEventListener('click', ()=>{ state.score=0; state.combo=0; el.score.textContent='0'; el.combo.textContent='0'; });
    el.saveImg.addEventListener('click', ()=>{ const a=document.createElement('a'); a.href=el.charImg.src; a.download=`BoysClickTooFast_${state.current}.png`; a.click(); });
  </script>
</body>
</html>
